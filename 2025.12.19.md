## 모델별 평균 성능 (Fold1/2 평균)

KD는 0.01, AT는 1000.0, SP는 1.0 파라미터 활용했습니다. 

| Model            | Building  | Bicyclist | Fence     | Pole      | Pedestrian | Road      | Sky       | SignSymbol | Tree      | Sidewalk  | Car       | **mIoU**  | **mPA**   | **aAcc**  |
| ---------------- | --------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- | --------- | --------- | --------- | --------- | --------- |
| **B0 (Student)** | 88.22     | 62.83     | 68.17     | 20.50     | 45.28      | 95.93     | 87.93     | 41.59      | 78.51     | 83.43     | 82.54     | **68.63** | **75.36** | **93.01** |
| **B2 (Teacher)** | 89.51     | 67.13     | 72.61     | 26.75     | 51.06      | 96.72     | 88.80     | 47.25      | 79.64     | 86.27     | 85.01     | **71.89** | **78.17** | **93.80** |
| **AT KD (Seed 1)** | 87.90 | 62.50 | 68.77 | 21.83 | 43.48 | 95.89 | 87.92 | 39.92 | 78.56 | 82.99 | 82.40 | **68.38** | **75.65** | **92.90** |
| **AT KD (Seed 2)** | 88.03 | 63.16 | 68.20 | 21.96 | 43.86 | 95.86 | 87.80 | 40.94 | 78.24 | 82.79 | 82.43 | **68.48** | **75.71** | **92.87** |
| **AT KD (Seed 3)** | 87.91 | 63.26 | 68.87 | 21.06 | 43.47 | 95.90 | 87.74 | 41.21 | 78.03 | 82.74 | 82.26 | **68.41** | **75.55** | **92.85** |
| **KL KD (Seed 1)** | 87.99 | 62.45 | 68.45 | 21.30 | 42.98 | 95.82 | 87.87 | 39.17 | 78.59 | 82.72 | 82.20 | **68.14** | **75.15** | **92.89** |
| **KL KD (Seed 2)** | 87.84 | 63.07 | 68.03 | 21.57 | 42.51 | 95.93 | 87.65 | 39.57 | 78.00 | 83.22 | 82.27 | **68.15** | **75.35** | **92.83** |
| **KL KD (Seed 3)** | 87.82 | 62.38 | 68.55 | 21.93 | 43.34 | 95.85 | 87.68 | 39.53 | 78.13 | 82.86 | 82.24 | **68.21** | **75.44** | **92.82** |
| **SP KD (Seed 1)** | 87.78 | 62.02 | 68.38 | 21.70 | 42.44 | 95.87 | 87.61 | 40.58 | 78.05 | 82.93 | 81.95 | **68.12** | **75.30** | **92.79** |
| **SP KD (Seed 2)** | 87.89 | 62.04 | 68.10 | 21.77 | 43.59 | 95.89 | 87.74 | 40.82 | 78.18 | 82.98 | 82.17 | **68.29** | **75.52** | **92.85** |
| **SP KD (Seed 3)** | 87.94 | 62.22 | 67.84 | 21.55 | 44.36 | 95.87 | 87.80 | 39.64 | 78.35 | 82.88 | 82.56 | **68.27** | **75.57** | **92.87** |

각 KD 방법론 별 분포 요약입니다.

| Method | Mean mIoU | Std (n−1) | 95% CI |
|--------|-----------|-----------|---------------------------|
| AT-KD  | **68.423** | **0.0510** | **[68.296 , 68.550]** |
| KL-KD  | **68.167** | **0.0382** | **[68.072 , 68.262]** |
| SP-KD  | **68.227** | **0.0931** | **[67.996 , 68.458]** |

## 모델별 평균 성능 (Fold1/2 평균) - B4 Teacher 기반

| Model            | Building  | Bicyclist | Fence     | Pole      | Pedestrian | Road      | Sky       | SignSymbol | Tree      | Sidewalk  | Car       | **mIoU**  | **mPA**   | **aAcc**  |
| ---------------- | --------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- | --------- | --------- | --------- | --------- | --------- |
| **B0 (Student)** | 88.22     | 62.83     | 68.17     | 20.50     | 45.28      | 95.93     | 87.93     | 41.59      | 78.51     | 83.43     | 82.54     | **68.63** | **75.36** | **93.01** |
| **B4 (Teacher)** | 89.70     | 68.84     | 73.09     | 28.62     | 51.72      | 96.80     | 88.88     | 48.04      | 79.67     | 86.60     | 85.73     | **72.52** | **78.76** | **93.89** |
| **AT KD (Seed 1)** | 87.96 | 61.32 | 67.47 | 21.96 | 43.38 | 95.78 | 87.75 | 40.29 | 78.09 | 82.52 | 81.92 | **68.04** | **75.33** | **92.80** |
| **AT KD (Seed 2)** | 87.72 | 62.58 | 68.61 | 22.43 | 43.29 | 95.84 | 87.71 | 40.45 | 78.08 | 82.90 | 82.03 | **68.33** | **75.76** | **92.79** |
| **AT KD (Seed 3)** | 87.96 | 62.26 | 68.44 | 21.59 | 43.74 | 95.97 | 87.83 | 40.40 | 78.18 | 83.09 | 82.50 | **68.36** | **75.56** | **92.90** |
| **KL KD (Seed 1)** | 87.87 | 61.84 | 67.41 | 21.68 | 43.35 | 95.85 | 87.71 | 39.36 | 78.10 | 82.89 | 82.38 | **68.04** | **75.39** | **92.81** |
| **KL KD (Seed 2)** | 87.86 | 62.20 | 67.92 | 22.21 | 43.68 | 95.86 | 87.68 | 39.04 | 77.92 | 82.85 | 82.50 | **68.16** | **75.58** | **92.80** |
| **KL KD (Seed 3)** | 87.80 | 62.13 | 68.36 | 21.98 | 43.88 | 95.91 | 87.40 | 39.21 | 77.92 | 82.97 | 82.40 | **68.18** | **75.57** | **92.79** |
| **SP KD (Seed 1)** | 87.88 | 62.04 | 68.75 | 21.51 | 43.50 | 95.87 | 87.53 | 40.28 | 77.99 | 83.01 | 82.51 | **68.26** | **75.65** | **92.81** |
| **SP KD (Seed 2)** | 87.87 | 62.87 | 67.70 | 21.90 | 43.68 | 95.94 | 87.73 | 40.02 | 78.20 | 83.10 | 82.25 | **68.30** | **75.51** | **92.86** |
| **SP KD (Seed 3)** | 87.76 | 61.87 | 67.58 | 21.77 | 43.34 | 95.86 | 87.65 | 40.56 | 77.96 | 82.96 | 82.18 | **68.14** | **75.34** | **92.78** |

각 KD 방법론 별 분포 요약입니다.

| Method | Mean mIoU | Std (n−1) | 95% CI |
|--------|-----------|-----------|---------------------------|
| AT-KD  | **68.243** | **0.1770** | **[67.803 , 68.683]** |
| KL-KD  | **68.127** | **0.0764** | **[67.939 , 68.315]** |
| SP-KD  | **68.233** | **0.0833** | **[68.026 , 68.440]** |

## 주간 보고

SegFormer 기반으로 semantic segmentation에 KD를 적용해 보려고 하면서, 우선 SegFormer → SegFormer 구조에서 쓸 수 있는 기존 KD 방법들이 어떤 게 있는지부터 살펴봤습니다. 교수님께서 주신 GitHub 자료를 중심으로 여러 방법들을 확인해 봤는데, 대부분이 다른 작업에 맞춰진 방법들이어서 Segmentation에 그대로 적용하기에는 좀 한계가 있다고 느꼈습니다.

교수님께서 전에 Frequency 관련 KD 논문을 읽어보라고 하신 게 기억났습니다. 그래서 기존의 KD 방법뿐 아니라 Frequency 관점에서 Semantic Segmentation에 적용할 수 있는 연구가 있을지 찾아보았고, 그 과정에서 FFR: Frequency Feature Rectification for Weakly Supervised Semantic Segmentation 논문을 발견하게 되었습니다.

<img width="475" height="307" alt="스크린샷 2025-12-18 오후 8 23 56" src="https://github.com/user-attachments/assets/d11cd8fd-adc7-4a2d-a840-f71077723e68" />

해당 그래프의 X축은 사용한 저주파 영역의 크기, 초록색 곡선은 저주파 성분만으로 구성된 Feature를 사용했을 때의 Segmentation 성능을 나타내고 있는데, 논문에서는 "Semantic Segmentation에서는 고주파(경계·노이즈) 정보보다, 전반적인 구조와 의미를 담고 있는 저주파 feature가 성능에 더 중요하다." 라고 주장하고 있습니다. 특히 FFR 논문에서는 decoder 단계에서 ViT가 추출한 Feature를 주파수 영역으로 변환한 뒤, 감쇠된 고주파 성분을 제거하고 저주파 성분만을 신뢰 가능한 Feature로 사용함으로써 False Segmentation 영역을 줄이는 접근을 취하고 있습니다.

이 아이디어를 기반으로 SegFormer 구조에서 decoder 단계, 특히 logit 직전의 feature map에 FFR에서 사용한 것과 유사한 frequency 분해를 적용한 뒤, teacher와 student의 저주파 feature만을 대상으로 KD를 수행하는 방식을 구현해 보았습니다.

한편, 이 과정에서 고주파 feature도 함께 전달해 주는 것이 좋지 않을까라는 고민도 들었습니다. 하지만 고주파 성분의 경우, teacher(B2)와 student(B0) 간 표현 차이가 크고, noise나 artifact 성분이 포함될 가능성이 높아 teacher의 고주파를 그대로 맞추는 KD는 오히려 성능에 악영향을 줄 수 있다는 점이 우려되었습니다. 이에 대해 여러 가능성을 검토한 결과, 고주파 처리 방식은 하나로 고정하지 않고 다음과 같은 세 가지 옵션으로 나누어 실험해 보기로 하였습니다.

```
Input Image
    ↓
Backbone (Encoder)
    ↓
Decoder Head (linear_fuse 후, dropout 전)
    ↓
FFM: low = FFM_low(x), high = x - low
    ↓
저주파 특징 맵 + 고주파 특징 맵
    ↓
┌─────────────────┬──────────────────────────────────────┐
│  저주파 KD Loss  │  고주파 처리 (설정에 따라 다름)      │
│  (MSE KD)        │  - 'kd': MSE KD (위험할 수 있음)    │
│                  │  - 'regularize': L1 정규화 (추천)    │
│                  │  - 'none': 사용 안 함                │
└─────────────────┴──────────────────────────────────────┘
    ↓
최종 Loss = Task Loss + λ × (저주파 KD Loss + 고주파 Loss)
```

우선, 파라미터 계수는 람다는 0.1, 저주파 영억은 0.2로 고주파는 정규화를 하는 방식으로 진행을 해봤는데 아직 실험을 한 번밖에 하지 못했지만 mIoU가 B2 -> B0 기존 방법론 기준 최고점 68.49가 나와서 주파수 관련 방법론을 더 많은 방식으로 적용해보면 좋을 거 같다는 생각이 들었습니다.
