# SegFormer B0 / B2 성능 비교 요약 (CamVid 11 Classes)

## 2. Fold 1 – Best 성능 비교 (가로 길게)

### 클래스별 IoU (가로 테이블)

| Class      | Sky       | Building  | Pole      | Road      | Pavement  | Tree      | SignSymbol | Fence     | Car       | Pedestrian | Bicyclist |
| ---------- | --------- | --------- | --------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- |
| **B0 IoU** | 88.66     | **69.93** | 66.44     | 21.14     | 40.54     | 95.67     | 87.00      | 49.01     | 77.45     | 82.11      | 83.74     |
| **B2 IoU** | **89.63** | 64.71     | **71.04** | **29.22** | **51.21** | **96.91** | **89.01**  | **51.91** | **80.09** | **86.77**  | **85.99** |

### Fold 1 모델별 Best 요약

| 모델     | Best mIoU  | mAcc       | aAcc       |
| ------ | ---------- | ---------- | ---------- |
| **B0** | 69.39%     | 76.37%     | 93.06%     |
| **B2** | **71.81%** | **78.54%** | **93.60%** |

## 3. Fold 2 – Best 성능 비교 (가로 길게)

### 클래스별 IoU (가로 테이블)

| Class      | Sky       | Building  | Pole      | Road      | Pavement  | Tree      | SignSymbol | Fence     | Car       | Pedestrian | Bicyclist |
| ---------- | --------- | --------- | --------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- |
| **B0 IoU** | 86.13     | **74.32** | 66.60     | 21.72     | 50.88     | **96.40** | 87.04      | 36.90     | 75.08     | 83.75      | **85.78** |
| **B2 IoU** | **89.56** | 69.64     | **75.11** | **30.32** | **51.37** | 96.69     | **88.90**  | **46.22** | **79.78** | **86.21**  | 84.24     |

### Fold 2 모델별 Best 요약

| 모델     | Best mIoU  | mAcc       | aAcc       |
| ------ | ---------- | ---------- | ---------- |
| **B0** | 69.37%     | 75.98%     | 92.83%     |
| **B2** | **72.28%** | **78.64%** | **93.58%** |

## 4. Fold 평균 – 최종 비교 (가로 길게)

### 클래스별 평균 IoU (가로 테이블)

| Class      | Sky       | Building  | Pole      | Road      | Pavement  | Tree      | SignSymbol | Fence     | Car       | Pedestrian | Bicyclist |
| ---------- | --------- | --------- | --------- | --------- | --------- | --------- | ---------- | --------- | --------- | ---------- | --------- |
| **B0 Avg** | 87.40     | **72.13** | 66.52     | 21.43     | 45.71     | 96.04     | 87.02      | 42.96     | 76.27     | 82.93      | 84.76     |
| **B2 Avg** | **89.60** | 67.18     | **73.08** | **29.77** | **51.29** | **96.80** | **88.96**  | **49.07** | **79.94** | **86.49**  | **85.12** |

### Fold 평균 성능 요약 (Best 기준)

| 모델               | 평균 mIoU    | 평균 mAcc    | 평균 aAcc    |
| ---------------- | ---------- | ---------- | ---------- |
| **SegFormer B0** | 69.38%     | 76.18%     | 92.95%     |
| **SegFormer B2** | **72.05%** | **78.59%** | **93.59%** |

## 5. 결론

* B2는 B0 대비 **+2.67% mIoU 향상**
* 특히 Road / Pole / Fence / Pedestrian 등 난도 높은 클래스 개선 폭 큼
* Teacher 모델로 B2 적합

# KD with KL Divergence

## 1. 실험 설정

### 기본 설정
- **해상도**: 288x288 (img_scale: 384x288)
- **Iterations**: 40,000
- **Cross-validation**: 2-fold
- **Batch Size**: 4

### Knowledge Distillation 설정
- **KD Method**: KL Divergence
- **Teacher Model**: SegFormer B2 (iter_40000.pth)
- **Student Model**: SegFormer B0 (pretrained weights 사용)
- **Temperature**: 4.0
- **KD Loss Weight**: 1.0 및 0.5 (두 가지 실험)
- **Total Loss**: `L_total = L_seg + w × L_KD`
  - `L_seg = CrossEntropyLoss(student_logits, gt_labels)` (weight=1.0)
  - `L_KD = T² × KL(softmax(student_logits/T) || softmax(teacher_logits/T))` (T=4.0)
  - `w = 1.0` 또는 `w = 0.5`

## 2. 최종 비교 표 (Best mIoU 기준)

| Class      | Sky       | Building  | Pole      | Road      | Pavement  | Tree      | SignSymbol | Fence     | Car       | Pedestrian | Bicyclist | mIoU | mAcc | aAcc |
|------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|----------|------|------|------|
| **B0** | 87.40 | **72.13** | 66.52 | 21.43 | 45.71 | 96.04 | 87.02 | 42.96 | 76.27 | 82.93 | 84.76 | **69.38** | **76.18** | **92.95** |
| **KD(KL) w=1.0** | **88.57** | 63.30 | **69.40** | **22.26** | 46.33 | 96.14 | **88.25** | **43.45** | **78.94** | 83.79 | 83.14 | 69.22 | **76.18** | 92.93 |
| **KD(KL) w=0.5** | 87.38 | 68.61 | 64.55 | 21.01 | **49.15** | **96.38** | 87.40 | 41.29 | 77.14 | **84.30** | **84.77** | 69.34 | 76.13 | 92.91 |

## 3. 상세 결과

### B0 (Baseline)
- **Fold 1**: mIoU 69.39% (iter 39000), mAcc 76.37%, aAcc 93.06%
- **Fold 2**: mIoU 69.37% (iter 34000), mAcc 75.98%, aAcc 92.83%
- **평균**: mIoU 69.38%, mAcc 76.18%, aAcc 92.95%

### KD(KL) w=1.0
- **Fold 1**: mIoU 69.41% (iter 36000), mAcc 76.55%, aAcc 93.10%
- **Fold 2**: mIoU 69.02% (iter 36000), mAcc 75.81%, aAcc 92.76%
- **평균**: mIoU 69.22%, mAcc 76.18%, aAcc 92.93%

### KD(KL) w=0.5
- **Fold 1**: mIoU 69.32% (iter 38000), mAcc 76.49%, aAcc 93.04%
- **Fold 2**: mIoU 69.35% (iter 40000), mAcc 76.05%, aAcc 92.85%
- **평균**: mIoU 69.34%, mAcc 76.13%, aAcc 92.91%

## 4. 요약
- **B0 Baseline**: mIoU 69.38% (기준선)
- **KD(KL) w=0.5**: mIoU 69.34% (B0 대비 -0.04%p, 거의 동일)
- **KD(KL) w=1.0**: mIoU 69.22% (B0 대비 -0.16%p, 거의 동일)
- 일부 클래스에서는 KD가 B0보다 우수한 성능을 보이지만, 전체적으로는 큰 차이가 없습니다.
